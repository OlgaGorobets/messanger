(this.webpackJsonpmy_editor=this.webpackJsonpmy_editor||[]).push([[0],{46:function(e,t,n){e.exports=n(75)},74:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(21),s=n(14),i=n(23),c=n(16),o=n(13),u=n(12);function m(e){var t=e?new Date(e):new Date,n=""+["Jan","Feb","March","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],a=""+t.getDate(),r=t.getFullYear(),l=t.getHours(),s=t.getMinutes();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),a+" "+n+","+r+" "+l+":"+s}var d="CHANGE_USER",f="ADD_MESSAGE",g="SET_LOOKED",E="ADD_LINK";var _={current_user_id:0,users:[{id:0,name:"User 1"},{id:1,name:"User 2"},{id:2,name:"User 3"}],links:[{link:"https://youtu.be/RAUlcZXp23k",title:"some title of link"}],messages:[{id:0,message:"text of message1",date:m(new Date),looked:!1,from_id:0,to_id:1},{id:1,message:"text of message2 https://youtu.be/RAUlcZXp23k",date:m(new Date),looked:!0,from_id:0,to_id:1},{id:2,message:"text of message3",date:m(new Date),looked:!0,from_id:1,to_id:0},{id:3,message:"text of message4",date:m(new Date),looked:!1,from_id:1,to_id:0}]},b=new WebSocket("ws://localhost:3030"),p=!1;b.onopen=function(){console.log("connected"),p=!0},b.onmessage=function(e){console.log(e)},b.onclose=function(){p=!1,console.log("disconnected")};var k=n(15),O=n(45),v=n(40),h=n(10),j=Object(s.b)((function(e){return{current_user_id:e.current_user_id,users:e.users}}))((function(e){var t=e.current_user_id,n=e.users,a=e.dispatch,l=n.filter((function(e){return e.id==t}));return r.a.createElement(h.a,null,r.a.createElement(h.a.Item,null,r.a.createElement("div",{className:"userBlock"},"Current user: ",l.length>0?n[0].name:"Undefined user","(id = ",t,")"),r.a.createElement("div",{className:"userList"},"Avaliable users ids: ",n.map((function(e){return e.id})).join(",")),r.a.createElement("div",{className:"userIdChange"},r.a.createElement("span",null,"Change Current User: "),r.a.createElement("input",{type:"text",value:t,onChange:function(e){var t;a((t=e.target.value,{type:d,id:t}))}}))))})),y=Object(k.e)(j),D=n(20),I=n(43),N=n(44),S=Object(s.b)((function(e){return{links:e.links}}))((function(e){var t=e.links,n=e.link,l=e.dispatch,s=Object(a.useState)(null),i=Object(D.a)(s,2),c=i[0],o=i[1];return Object(a.useEffect)((function(){console.log("gogogog");var e=t.filter((function(e){return e.link==n}));e.length>0?o(Object(u.a)({},e[0])):function(){var e=new FormData;return e.append("link",n),Object(I.post)("/link.php",e)}().then((function(e){var t,a=e.data;console.log(0==a.error,a),0==a.error&&l((t={link:n,title:a.title},{type:E,title:t.title,link:t.link}))}))}),[t]),r.a.createElement(h.a,null,r.a.createElement(h.a.Item,null,null!==c?r.a.createElement(r.a.Fragment,null,c.title):r.a.createElement(N.a,{animation:"border",variant:"secondary"})))})),w=Object(k.e)(S),x=n(19),C=n(17),F=Object(s.b)((function(e){return{current_user_id:e.current_user_id,users:e.users,messages:e.messages}}))((function(e){var t=e.current_user_id,n=e.users,l=e.messages,s=e.dispatch,i=Object(a.useState)(""),c=Object(D.a)(i,2),o=c[0],m=c[1],d=n.filter((function(e){return e.id==parseInt(t)})),E=n.filter((function(e){return d.length>0&&e.id!==parseInt(t)})),_=E.length>0?E[0]:null,b=Object(a.useState)(null),p=Object(D.a)(b,2),k=p[0],O=p[1],v=function(e){var n;e.preventDefault(),o.trim().length>0&&(s((n={message:o,from_id:t,to_id:k.id},{type:f,message:n.message,from_id:n.from_id,to_id:n.to_id})),m(""))};return Object(a.useEffect)((function(){O(Object(u.a)({},_))}),[_]),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,null,r.a.createElement(x.a,null,r.a.createElement(C.a,{className:"messagesContainer"},r.a.createElement(h.a.Item,null,l.filter((function(e){return k&&e.from_id==parseInt(t)&&e.to_id==k.id||k&&e.from_id==k.id&&e.to_id==parseInt(t)})).map((function(e,a){var l=n.filter((function(e){return e.id==k.id})),s=l.length>0?l[0]:null,i=["youtu.be","youtube.com"],c=-1!==e.message.indexOf(i[0])||-1!==e.message.indexOf(i[1]);return r.a.createElement(h.a.Item,{className:e.from_id==parseInt(t)?"messMy":"messMe",key:a,variant:e.from_id!==parseInt(t)?e.looked?"":"info":"light"},r.a.createElement(x.a,null,s&&e.from_id!==parseInt(t)?r.a.createElement(C.a,null,s.name):r.a.createElement(r.a.Fragment,null)),r.a.createElement(x.a,null,r.a.createElement(C.a,null,c?r.a.createElement(r.a.Fragment,null,e.message.split(" ").map((function(e,t){return r.a.createElement("div",{key:t},-1!==e.indexOf(i[0])||-1!==e.indexOf(i[1])," ?",r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:e,target:"_blank"},e),r.a.createElement(w,{link:e})),' : (pt + " ")}')}))):e.message),r.a.createElement(C.a,null,e.date)))}))),E.length>0?r.a.createElement(h.a.Item,null,r.a.createElement("form",{onSubmit:v},r.a.createElement("div",null,r.a.createElement("textarea",{type:"text",id:"input01",onChange:function(e){m(e.target.value)},size:"sm",value:o,placeholder:"Your message...",onClick:function(){var e;s((e={from_id:k.id,to_id:t},{type:g,from_id:e.from_id,to_id:e.to_id}))}})),r.a.createElement("button",{onClick:v,type:"submit"},"Send Message"))):r.a.createElement(r.a.Fragment,null)),r.a.createElement(C.a,{className:"friendsContainer"},E.map((function(e,t){return r.a.createElement(h.a.Item,{onClick:function(t){!function(e,t){e.preventDefault(),O(Object(u.a)({},t))}(t,e)},variant:null!==k&&e.id==k.id?"info":"",key:t},e.name)}))))))})),A=Object(k.e)(F),M=function(e){return Object(v.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null),r.a.createElement(A,null))};n(74);var J=Object(k.e)((function(e){return e.location,Object(a.useEffect)((function(){}),[]),r.a.createElement(O.a,null,r.a.createElement("div",{className:"headerBlock"},r.a.createElement(c.b,{className:"mainLogoLink",to:"/"},r.a.createElement("h1",{className:"mainLogo"},"Messanger"))),r.a.createElement("div",{className:"contentBlock"},r.a.createElement(k.a,{exact:!0,path:"/",component:M})))})),U=Object(i.b)((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d:return Object(u.a)({},t,{current_user_id:n.id});case f:var a={id:t.messages.length>0?t.messages[t.messages.length-1].id+1:0,message:n.message,looked:!1,from_id:n.from_id,to_id:n.to_id,date:m(new Date)};return e={data:[].concat(Object(o.a)(t.messages),[a]),name:"messages"},p&&b.send(JSON.stringify(e)),Object(u.a)({},t,{messages:[].concat(Object(o.a)(t.messages),[a])});case g:var r=t.messages.map((function(e){var t=Object(u.a)({},e);return e.from_id==n.from_id&&e.to_id==e.to_id&&(t.looked=!0),t}));return e={data:Object(o.a)(r),name:"messages"},p&&b.send(JSON.stringify(e)),Object(u.a)({},t,{messages:Object(o.a)(r)});case E:console.log("add link",n.link,n.title);var l=Object(o.a)(t.links);return 0==t.links.filter((function(e){return n.link==e.link})).length&&(l=[].concat(Object(o.a)(t.links),[{link:n.link,title:n.title}])),e={data:Object(o.a)(l),name:"links"},p&&b.send(JSON.stringify(e)),Object(u.a)({},t,{links:Object(o.a)(l)});default:return t}}));Object(l.render)(r.a.createElement(s.a,{store:U},r.a.createElement(c.a,null,r.a.createElement(J,null))),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.5452445f.chunk.js.map